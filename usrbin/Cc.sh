#!/bin/sh

cwd=`pwd`

    # Build with 4arg mappings enabled
    $cwd/tools/misc/abs_path_filter -top $cwd -object $cwd/platforms/viking/drivers/fpgalib/lib/obj-x86e-nto/fpgalib_test.o \
      " /router/bin/icc.10.2.014b.i686-linux  @$cwd/build/native-icc-cc.cfg  @$cwd/build/native-icc-cc-per-dir.cfg  -c -include $cwd/build/icc-preincl.h -g -pipe -fsigned-char -fno-builtin -nostdinc -DMAP_4ARG_WRITE_LOG -m32 -D__CISCO_IL_MODE__ -D__QNXNTO__ -D__IOSNG__ -DNTO_BUILD=64 -D__X86__ -D__LITTLEENDIAN__ -DOBJECT_X86 -DPLATFORM_INDIRECT_32BIT -DPLATFORM_INDIRECT_16BIT -DPLATFORM_INDIRECT_8BIT -Dfalse=0 -Dtrue=1 -D__BASE_OS_NTO__ -D__X86_LINUX__ -D__SLIB_DATA_INDIRECT -DTARGET_CISCO -DQSTAR_REVISIT -D__IOX_DLL__ -DBUILDENV_iox -DRM_DLLMGR_TMP= -D__USE_DLLMGR__ -Wall -Wno-uninitialized -Wpointer-arith -Wformat    -DFORMAT_CHECK_ALL=1 -D__DO4ARG__ -DFORMAT_CHECK_ALL=1 \
      -O1 -fno-strict-aliasing -fno-omit-frame-pointer -Iplatforms/viking/drivers/fpgalib/lib/src -Iplatforms/viking/drivers/fpgalib/lib/obj-x86e-nto -Iplatforms/viking/drivers/fpgalib/lib/src/gen -Iplatforms/viking/drivers/fpgalib/lib/src/gen/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/gpio/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/i2c/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/i2c/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/scc/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/i2cafp/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/1588/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/1588/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/runa/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_runa/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/atli/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_atli/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_banki/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/cupola/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/grindr/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/illugi/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/lambi/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/cbc/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/np/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/np/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/np/typhoon/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/np/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fia/skt/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/fia/skt/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/fia/tsk/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/arb/lancer/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/xbar/sac/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/xbar/sac/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xbar/sm15/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mux/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/muxphy/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/afp/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/afp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mac/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/mem/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/hmac/asgard/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/hmac/pthrumac/ver_101 -Iplatforms/viking/drivers/fpgalib/lib/src/starkad/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/ragnar/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/gambit/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/rogue/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/blackwidow/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/whiplash/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/arb/lightning/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/arb/lightning/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/ep/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/sage/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/slab/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/slab/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/led/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/led/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/pixie/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/ipu/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/intrpt/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/uxbar/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/wd/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/dg/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/ectw/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/qspi/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/hw_log/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mbox/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/lpc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rclk_mux/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xil_dev/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/info_rom/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/tail/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/nvsram_par/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/x86_ctrl/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/cpak/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/gbox/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/zpll/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/misc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fpga/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/cpu/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xge/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/pex/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fpga -Iplatforms/viking/drivers/fpgalib/lib/src/cpi/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fab/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_leds/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/smb/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fc_cfg_sts/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/i2cafp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_uarts_mbar/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/dti/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/tsp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/ds3100/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xpnt/ver_4 -Iinc/x86e-nto/global/iosxr-os -Iinc/x86e-nto/global/iosxr-os/os -Iinc/x86e-nto/global/iosxr-os/os/qnx-wrappers -Iinc/x86e-nto/global/iosxr-infra/scripting/slang/slang_210 -Iinfra/xoslib/include -Iinc/x86e-nto/package/asr9k-os-supp/platforms/viking/drivers/fpgalib/lib -Iinc/x86e-nto/global/asr9k-os-supp/platforms/viking/drivers/fpgalib/lib -Iinc/x86e-nto/package/asr9k-os-supp -Iinc/x86e-nto/global/asr9k-os-supp -Iinc/x86e-nto/global/iosxr-routing -Iinc/x86e-nto/global/iosxr-fwding -Iinc/x86e-nto/global/iosxr-infra -Iinc/x86e-nto/global/iosxr-os -Iinc/x86e-nto/global/asr9k-cpp -Iinc/x86e-nto/global/asr9k-fwding -Iinc/x86e-nto/global/asr9k-base -Iplatforms/viking/drivers/fpgalib/lib/src -Iplatforms/viking/drivers/fpgalib/lib/src/h -Iplatforms/viking/drivers/fpgalib/lib/src/gen -Iplatforms/viking/drivers/fpgalib/lib/src/gen/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/gpio/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/fab/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/mdio/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/i2c/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/i2c/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/scc/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/i2cafp/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/1588/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/1588/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/runa/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_runa/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/atli/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_atli/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/super_banki/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/cupola/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/grindr/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/illugi/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/lambi/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/cbc/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/np/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/np/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/np/typhoon/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/fia/skt/ver_0 -Iplatforms/viking/drivers/fpgalib/lib/src/fia/skt/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/arb/lancer/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/xbar/sac/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/mux/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/muxphy/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/afp/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/afp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mac/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/mem/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/hmac/asgard/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/hmac/pthrumac/ver_101 -Iplatforms/viking/drivers/fpgalib/lib/src/starkad/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/ragnar/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/gambit/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/rogue/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/blackwidow/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/whiplash/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/arb/lightning/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/ep/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/sage/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/slab/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/led/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/led/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/pixie/ver_1 -Iplatforms/viking/drivers/fpgalib/lib/src/ipu/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/intrpt/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/uxbar/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/wd/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/dg/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/ectw/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/qspi/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/hw_log/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/mbox/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/lpc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rclk_mux/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xil_dev/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/info_rom/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/tail/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/nvsram_par/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/x86_ctrl/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/misc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fpga -Iplatforms/viking/drivers/fpgalib/lib/src/cpi/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fab/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_leds/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_fc/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/smb/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/fc_cfg_sts/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/i2cafp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/rp_uarts_mbar/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/dti/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/tsp/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/ds3100/ver_4 -Iplatforms/viking/drivers/fpgalib/lib/src/xpnt/ver_4 \
      -include $cwd/infra/sec/include/danger_map.h -o $cwd/platforms/viking/drivers/fpgalib/lib/obj-x86e-nto/fpgalib_test.o $cwd/platforms/viking/drivers/fpgalib/lib/src/gen/fpgalib_test.c "
    gcc_exit=$?
    # If there is a log file
    if [ -f $cwd/fpgalib_test.c.4arg ]; then
      # If it doesn't exist, create the log directory at
      # 4arg/logs//router/bin/icc.10.2.014b.i686-linux . 4arg/logs/@$cwd/build/native-icc-cc.cfg . 4arg/logs/@$cwd/build/native-icc-cc-per-dir.cfg .
      test -d $cwd/infra/sec/logs//router/bin/icc.10.2.014b.i686-linux  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc.cfg  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc-per-dir.cfg  || \
      /bin/mkdir -p $cwd/infra/sec/logs//router/bin/icc.10.2.014b.i686-linux  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc.cfg  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc-per-dir.cfg  ;

      # Move any log files to the log directory.
      cp $cwd/fpgalib_test.c.4arg $cwd/infra/sec/logs//router/bin/icc.10.2.014b.i686-linux  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc.cfg  $cwd/infra/sec/logs/@$cwd/build/native-icc-cc-per-dir.cfg  ;
      rm -f $cwd/fpgalib_test.c.4arg ;
    fi
    exit $gcc_exit
